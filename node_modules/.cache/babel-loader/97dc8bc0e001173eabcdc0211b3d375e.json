{"ast":null,"code":"import { __spreadArray } from \"tslib\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport styles from './styles.css.js';\nimport clsx from 'clsx';\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\nimport React, { useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { fireNonCancelableEvent } from '../../events';\nimport { calculatePosition } from './dropdown-fit-handler';\nimport { Transition } from '../transition';\nimport { useVisualRefresh } from '../../hooks/use-visual-mode';\nimport { usePortalModeClasses } from '../../hooks/use-portal-mode-classes';\nimport { DropdownContextProvider } from './context';\nimport { useMobile } from '../../hooks/use-mobile';\nimport TabTrap from '../tab-trap/index.js';\nimport { getFirstFocusable, getLastFocusable } from '../focus-lock/utils.js';\n\nvar DropdownContainer = function (_a) {\n  var children = _a.children,\n      _b = _a.renderWithPortal,\n      renderWithPortal = _b === void 0 ? false : _b,\n      id = _a.id,\n      open = _a.open;\n\n  if (renderWithPortal) {\n    if (open) {\n      return createPortal(React.createElement(\"div\", {\n        id: id\n      }, children), document.body);\n    } else {\n      return null;\n    }\n  } else {\n    return React.createElement(React.Fragment, null, children);\n  }\n};\n\nvar TransitionContent = function (_a) {\n  var _b;\n\n  var state = _a.state,\n      transitionRef = _a.transitionRef,\n      dropdownClasses = _a.dropdownClasses,\n      stretchWidth = _a.stretchWidth,\n      interior = _a.interior,\n      hasContent = _a.hasContent,\n      isRefresh = _a.isRefresh,\n      dropdownRef = _a.dropdownRef,\n      verticalContainerRef = _a.verticalContainerRef,\n      expandToViewport = _a.expandToViewport,\n      header = _a.header,\n      children = _a.children,\n      footer = _a.footer,\n      position = _a.position,\n      open = _a.open,\n      onMouseDown = _a.onMouseDown;\n  var contentRef = useMergeRefs(dropdownRef, transitionRef);\n  return React.createElement(\"div\", {\n    className: clsx(styles.dropdown, dropdownClasses, (_b = {}, _b[styles.open] = open, _b[styles['with-limited-width']] = !stretchWidth, _b[styles['hide-upper-border']] = stretchWidth, _b[styles.interior] = interior, _b[styles['is-empty']] = !header && !hasContent, _b[styles.refresh] = isRefresh, _b[styles['use-portal']] = expandToViewport && !interior, _b)),\n    ref: contentRef,\n    \"data-open\": open,\n    \"data-animating\": state !== 'exited',\n    onMouseDown: onMouseDown\n  }, React.createElement(\"div\", {\n    className: clsx(styles['dropdown-content-wrapper'], isRefresh && styles.refresh)\n  }, React.createElement(\"div\", {\n    className: styles['ie11-wrapper']\n  }, React.createElement(\"div\", {\n    ref: verticalContainerRef,\n    className: styles['dropdown-content']\n  }, React.createElement(DropdownContextProvider, {\n    position: position\n  }, header, children, footer)))));\n};\n\nvar Dropdown = function (_a) {\n  var children = _a.children,\n      trigger = _a.trigger,\n      open = _a.open,\n      onDropdownClose = _a.onDropdownClose,\n      onMouseDown = _a.onMouseDown,\n      header = _a.header,\n      footer = _a.footer,\n      dropdownId = _a.dropdownId,\n      _b = _a.stretchTriggerHeight,\n      stretchTriggerHeight = _b === void 0 ? false : _b,\n      _c = _a.stretchWidth,\n      stretchWidth = _c === void 0 ? true : _c,\n      _d = _a.stretchHeight,\n      stretchHeight = _d === void 0 ? false : _d,\n      _e = _a.stretchToTriggerWidth,\n      stretchToTriggerWidth = _e === void 0 ? true : _e,\n      _f = _a.expandToViewport,\n      expandToViewport = _f === void 0 ? false : _f,\n      _g = _a.preferCenter,\n      preferCenter = _g === void 0 ? false : _g,\n      _h = _a.interior,\n      interior = _h === void 0 ? false : _h,\n      minWidth = _a.minWidth,\n      _j = _a.hasContent,\n      hasContent = _j === void 0 ? true : _j,\n      _k = _a.scrollable,\n      scrollable = _k === void 0 ? true : _k,\n      _l = _a.trapFocus,\n      trapFocus = _l === void 0 ? false : _l;\n  var triggerRef = useRef(null);\n  var dropdownRef = useRef(null); // This container is only needed to apply max-height to. We can't move max-height to it's parent\n  // because of an IE11 issue with flexbox. https://github.com/philipwalton/flexbugs/issues/216\n\n  var verticalContainerRef = useRef(null); // To keep track of the initial position (drop up/down) which is kept the same during fixed repositioning\n\n  var fixedPosition = useRef(null);\n  var isRefresh = useVisualRefresh(triggerRef);\n  var dropdownClasses = usePortalModeClasses(triggerRef);\n\n  var _m = useState('bottom-right'),\n      position = _m[0],\n      setPosition = _m[1];\n\n  var isMobile = useMobile();\n\n  var setDropdownPosition = function (position, triggerBox, target, verticalContainer) {\n    var entireWidth = !interior && stretchWidth;\n\n    if (!stretchWidth) {\n      // 1px offset for dropdowns where the dropdown itself needs a border, rather than on the items\n      verticalContainer.style.maxHeight = \"\".concat(parseInt(position.height) + 1, \"px\");\n    } else {\n      verticalContainer.style.maxHeight = position.height;\n    }\n\n    if (entireWidth && !expandToViewport) {\n      if (stretchToTriggerWidth) {\n        target.classList.add(styles['occupy-entire-width']);\n      }\n    } else {\n      target.style.width = position.width;\n    } // Using styles for main dropdown to adjust its position as preferred alternative\n\n\n    if (position.dropUp && !interior) {\n      target.classList.add(styles['dropdown-drop-up']);\n\n      if (!expandToViewport) {\n        target.style.bottom = '100%';\n      }\n    } else {\n      target.classList.remove(styles['dropdown-drop-up']);\n    }\n\n    target.classList.add(position.dropLeft ? styles['dropdown-drop-left'] : styles['dropdown-drop-right']);\n\n    if (position.left && position.left !== 'auto') {\n      target.style.left = position.left;\n    } // Position normal overflow dropdowns with fixed positioning relative to viewport\n\n\n    if (expandToViewport && !interior) {\n      target.style.position = 'fixed';\n\n      if (position.dropUp) {\n        target.style.bottom = \"calc(100% - \".concat(triggerBox.top, \"px)\");\n      } else {\n        target.style.top = \"\".concat(triggerBox.bottom, \"px\");\n      }\n\n      if (position.dropLeft) {\n        target.style.left = \"calc(\".concat(triggerBox.right, \"px - \").concat(position.width, \")\");\n      } else {\n        target.style.left = \"\".concat(triggerBox.left, \"px\");\n      } // Keep track of the initial dropdown position and direction.\n      // Dropdown direction doesn't need to change as the user scrolls, just needs to stay attached to the trigger.\n\n\n      fixedPosition.current = position;\n      return;\n    } // For an interior dropdown (the fly out) we need exact values for positioning\n    // and classes are not enough\n    // usage of relative position is impossible due to overwrite of overflow-x\n\n\n    if (interior && isInteriorPosition(position)) {\n      if (position.dropUp) {\n        target.style.bottom = position.bottom;\n      } else {\n        target.style.top = position.top;\n      }\n\n      target.style.left = position.left;\n    }\n\n    if (position.dropUp && position.dropLeft) {\n      setPosition('top-left');\n    } else if (position.dropUp) {\n      setPosition('top-right');\n    } else if (position.dropLeft) {\n      setPosition('bottom-left');\n    } else {\n      setPosition('bottom-right');\n    }\n  };\n\n  useLayoutEffect(function () {\n    var onDropdownOpen = function () {\n      if (open && dropdownRef.current && triggerRef.current && verticalContainerRef.current) {\n        // calculate scroll width only for dropdowns that has a scrollbar and ignore it for date picker components\n        if (scrollable) {\n          dropdownRef.current.classList.add(styles.nowrap);\n        }\n\n        setDropdownPosition.apply(void 0, __spreadArray(__spreadArray([], calculatePosition(dropdownRef.current, triggerRef.current, verticalContainerRef.current, interior, expandToViewport, preferCenter, stretchWidth, stretchHeight, isMobile, minWidth), false), [dropdownRef.current, verticalContainerRef.current], false));\n\n        if (scrollable) {\n          dropdownRef.current.classList.remove(styles.nowrap);\n        }\n      }\n    };\n\n    onDropdownOpen();\n\n    if (open) {\n      // window may scroll when dropdown opens, for example when soft keyboard shows up\n      window.addEventListener('scroll', onDropdownOpen); // only listen to window scroll within very short time after the dropdown opens\n      // do not want to interfere dropdown position on scroll afterwards\n\n      var timeoutId_1 = setTimeout(function () {\n        window.removeEventListener('scroll', onDropdownOpen);\n      }, 500);\n      return function () {\n        clearTimeout(timeoutId_1);\n        window.removeEventListener('scroll', onDropdownOpen);\n      };\n    } // See AWSUI-13040\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [open, dropdownRef, triggerRef, verticalContainerRef, interior, stretchWidth, isMobile]); // subscribe to outside click\n\n  useEffect(function () {\n    if (!open) {\n      return;\n    }\n\n    var clickListener = function (e) {\n      var _a;\n\n      if (!((_a = dropdownRef.current) === null || _a === void 0 ? void 0 : _a.contains(e.target))) {\n        fireNonCancelableEvent(onDropdownClose);\n      }\n    };\n    /*\n     * This small delay allows the event that opened the dropdown to\n     * finish bubbling, so that it is not immediately captured here.\n     */\n\n\n    var timeout = setTimeout(function () {\n      window.addEventListener('click', clickListener);\n    }, 0);\n    return function () {\n      clearTimeout(timeout);\n      window.removeEventListener('click', clickListener);\n    };\n  }, [open, onDropdownClose]); // sync dropdown position on scroll and resize\n\n  useLayoutEffect(function () {\n    if (!expandToViewport || !open) {\n      return;\n    }\n\n    var updateDropdownPosition = function () {\n      if (triggerRef.current && dropdownRef.current && verticalContainerRef.current) {\n        var triggerRect = triggerRef.current.getBoundingClientRect();\n        var target = dropdownRef.current;\n\n        if (fixedPosition.current) {\n          if (fixedPosition.current.dropUp) {\n            dropdownRef.current.style.bottom = \"calc(100% - \".concat(triggerRect.top, \"px)\");\n          } else {\n            target.style.top = \"\".concat(triggerRect.bottom, \"px\");\n          }\n\n          if (fixedPosition.current.dropLeft) {\n            target.style.left = \"calc(\".concat(triggerRect.right, \"px - \").concat(fixedPosition.current.width, \")\");\n          } else {\n            target.style.left = \"\".concat(triggerRect.left, \"px\");\n          }\n        }\n      }\n    };\n\n    updateDropdownPosition();\n    window.addEventListener('scroll', updateDropdownPosition, true);\n    window.addEventListener('resize', updateDropdownPosition, true);\n    return function () {\n      window.removeEventListener('scroll', updateDropdownPosition, true);\n      window.removeEventListener('resize', updateDropdownPosition, true);\n    };\n  }, [open, expandToViewport]);\n  return React.createElement(\"div\", {\n    className: clsx(styles.root, interior && styles.interior, stretchTriggerHeight && styles['stretch-trigger-height'])\n  }, React.createElement(\"div\", {\n    className: clsx(stretchTriggerHeight && styles['stretch-trigger-height']),\n    ref: triggerRef\n  }, trigger), React.createElement(TabTrap, {\n    focusNextCallback: function () {\n      var _a;\n\n      return dropdownRef.current && ((_a = getFirstFocusable(dropdownRef.current)) === null || _a === void 0 ? void 0 : _a.focus());\n    },\n    disabled: !open || !trapFocus\n  }), React.createElement(DropdownContainer, {\n    renderWithPortal: expandToViewport && !interior,\n    id: dropdownId,\n    open: open\n  }, React.createElement(Transition, {\n    \"in\": open !== null && open !== void 0 ? open : false,\n    exit: false\n  }, function (state, ref) {\n    return React.createElement(\"div\", {\n      onBlur: function (event) {\n        return trapFocus && event.stopPropagation();\n      }\n    }, React.createElement(TabTrap, {\n      focusNextCallback: function () {\n        var _a;\n\n        return triggerRef.current && ((_a = getLastFocusable(triggerRef.current)) === null || _a === void 0 ? void 0 : _a.focus());\n      },\n      disabled: !open || !trapFocus\n    }), React.createElement(TransitionContent, {\n      state: state,\n      transitionRef: ref,\n      dropdownClasses: dropdownClasses,\n      open: open,\n      stretchWidth: stretchWidth,\n      interior: interior,\n      header: header,\n      hasContent: hasContent,\n      expandToViewport: expandToViewport,\n      footer: footer,\n      onMouseDown: onMouseDown,\n      isRefresh: isRefresh,\n      dropdownRef: dropdownRef,\n      verticalContainerRef: verticalContainerRef,\n      position: position\n    }, children), React.createElement(TabTrap, {\n      focusNextCallback: function () {\n        var _a;\n\n        return triggerRef.current && ((_a = getFirstFocusable(triggerRef.current)) === null || _a === void 0 ? void 0 : _a.focus());\n      },\n      disabled: !open || !trapFocus\n    }));\n  })));\n};\n\nvar isInteriorPosition = function (position) {\n  return position.bottom !== undefined;\n};\n\nexport default Dropdown;","map":{"version":3,"mappings":"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","names":["styles","clsx","useMergeRefs","React","useEffect","useLayoutEffect","useRef","useState","createPortal","fireNonCancelableEvent","calculatePosition","Transition","useVisualRefresh","usePortalModeClasses","DropdownContextProvider","useMobile","TabTrap","getFirstFocusable","getLastFocusable","DropdownContainer","_a","children","_b","renderWithPortal","id","open","document","body","TransitionContent","state","transitionRef","dropdownClasses","stretchWidth","interior","hasContent","isRefresh","dropdownRef","verticalContainerRef","expandToViewport","header","footer","position","onMouseDown","contentRef","className","dropdown","refresh","ref","Dropdown","trigger","onDropdownClose","dropdownId","stretchTriggerHeight","_c","_d","stretchHeight","_e","stretchToTriggerWidth","_f","_g","preferCenter","_h","minWidth","_j","_k","scrollable","_l","trapFocus","triggerRef","fixedPosition","setPosition","isMobile","setDropdownPosition","triggerBox","target","verticalContainer","entireWidth","style","maxHeight","parseInt","height","classList","add","width","dropUp","bottom","remove","dropLeft","left","top","right","concat","current","isInteriorPosition","onDropdownOpen","nowrap","__spreadArray","window","addEventListener","timeoutId_1","setTimeout","removeEventListener","clearTimeout","clickListener","e","contains","timeout","updateDropdownPosition","triggerRect","getBoundingClientRect","root","focusNextCallback","focus","disabled","exit","onBlur","event","stopPropagation","undefined"],"sourceRoot":"","sources":["../../../../../src/internal/components/dropdown/index.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport styles from './styles.css.js';\nimport clsx from 'clsx';\nimport { useMergeRefs } from '../../hooks/use-merge-refs';\nimport React, { useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { fireNonCancelableEvent } from '../../events';\nimport { DropdownProps } from './interfaces';\nimport { DropdownPosition, InteriorDropdownPosition, calculatePosition } from './dropdown-fit-handler';\nimport { Transition, TransitionStatus } from '../transition';\nimport { useVisualRefresh } from '../../hooks/use-visual-mode';\nimport { usePortalModeClasses } from '../../hooks/use-portal-mode-classes';\nimport { DropdownContextProvider, DropdownContextProviderProps } from './context';\nimport { useMobile } from '../../hooks/use-mobile';\nimport TabTrap from '../tab-trap/index.js';\nimport { getFirstFocusable, getLastFocusable } from '../focus-lock/utils.js';\n\ninterface DropdownContainerProps {\n  children?: React.ReactNode;\n  renderWithPortal?: boolean;\n  id?: string;\n  open?: boolean;\n}\n\nconst DropdownContainer = ({ children, renderWithPortal = false, id, open }: DropdownContainerProps) => {\n  if (renderWithPortal) {\n    if (open) {\n      return createPortal(<div id={id}>{children}</div>, document.body);\n    } else {\n      return null;\n    }\n  } else {\n    return <>{children}</>;\n  }\n};\n\ninterface TransitionContentProps {\n  state: TransitionStatus;\n  transitionRef: React.MutableRefObject<any>;\n  dropdownClasses: string;\n  stretchWidth: boolean;\n  interior: boolean;\n  hasContent: boolean;\n  isRefresh: boolean;\n  dropdownRef: React.RefObject<HTMLDivElement>;\n  verticalContainerRef: React.RefObject<HTMLDivElement>;\n  expandToViewport?: boolean;\n  header?: React.ReactNode;\n  children?: React.ReactNode;\n  footer?: React.ReactNode;\n  position?: DropdownContextProviderProps['position'];\n  open?: boolean;\n  onMouseDown?: React.MouseEventHandler<Element>;\n}\n\nconst TransitionContent = ({\n  state,\n  transitionRef,\n  dropdownClasses,\n  stretchWidth,\n  interior,\n  hasContent,\n  isRefresh,\n  dropdownRef,\n  verticalContainerRef,\n  expandToViewport,\n  header,\n  children,\n  footer,\n  position,\n  open,\n  onMouseDown,\n}: TransitionContentProps) => {\n  const contentRef = useMergeRefs(dropdownRef, transitionRef);\n  return (\n    <div\n      className={clsx(styles.dropdown, dropdownClasses, {\n        [styles.open]: open,\n        [styles['with-limited-width']]: !stretchWidth,\n        [styles['hide-upper-border']]: stretchWidth,\n        [styles.interior]: interior,\n        [styles['is-empty']]: !header && !hasContent,\n        [styles.refresh]: isRefresh,\n        [styles['use-portal']]: expandToViewport && !interior,\n      })}\n      ref={contentRef}\n      data-open={open}\n      data-animating={state !== 'exited'}\n      onMouseDown={onMouseDown}\n    >\n      <div className={clsx(styles['dropdown-content-wrapper'], isRefresh && styles.refresh)}>\n        <div className={styles['ie11-wrapper']}>\n          <div ref={verticalContainerRef} className={styles['dropdown-content']}>\n            <DropdownContextProvider position={position}>\n              {header}\n              {children}\n              {footer}\n            </DropdownContextProvider>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst Dropdown = ({\n  children,\n  trigger,\n  open,\n  onDropdownClose,\n  onMouseDown,\n  header,\n  footer,\n  dropdownId,\n  stretchTriggerHeight = false,\n  stretchWidth = true,\n  stretchHeight = false,\n  stretchToTriggerWidth = true,\n  expandToViewport = false,\n  preferCenter = false,\n  interior = false,\n  minWidth,\n  hasContent = true,\n  scrollable = true,\n  trapFocus = false,\n}: DropdownProps) => {\n  const triggerRef = useRef<HTMLDivElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  // This container is only needed to apply max-height to. We can't move max-height to it's parent\n  // because of an IE11 issue with flexbox. https://github.com/philipwalton/flexbugs/issues/216\n  const verticalContainerRef = useRef<HTMLDivElement>(null);\n  // To keep track of the initial position (drop up/down) which is kept the same during fixed repositioning\n  const fixedPosition = useRef<DropdownPosition | null>(null);\n\n  const isRefresh = useVisualRefresh(triggerRef);\n\n  const dropdownClasses = usePortalModeClasses(triggerRef);\n  const [position, setPosition] = useState<DropdownContextProviderProps['position']>('bottom-right');\n\n  const isMobile = useMobile();\n\n  const setDropdownPosition = (\n    position: DropdownPosition | InteriorDropdownPosition,\n    triggerBox: DOMRect,\n    target: HTMLDivElement,\n    verticalContainer: HTMLDivElement\n  ) => {\n    const entireWidth = !interior && stretchWidth;\n    if (!stretchWidth) {\n      // 1px offset for dropdowns where the dropdown itself needs a border, rather than on the items\n      verticalContainer.style.maxHeight = `${parseInt(position.height) + 1}px`;\n    } else {\n      verticalContainer.style.maxHeight = position.height;\n    }\n\n    if (entireWidth && !expandToViewport) {\n      if (stretchToTriggerWidth) {\n        target.classList.add(styles['occupy-entire-width']);\n      }\n    } else {\n      target.style.width = position.width;\n    }\n    // Using styles for main dropdown to adjust its position as preferred alternative\n    if (position.dropUp && !interior) {\n      target.classList.add(styles['dropdown-drop-up']);\n      if (!expandToViewport) {\n        target.style.bottom = '100%';\n      }\n    } else {\n      target.classList.remove(styles['dropdown-drop-up']);\n    }\n    target.classList.add(position.dropLeft ? styles['dropdown-drop-left'] : styles['dropdown-drop-right']);\n\n    if (position.left && position.left !== 'auto') {\n      target.style.left = position.left;\n    }\n\n    // Position normal overflow dropdowns with fixed positioning relative to viewport\n    if (expandToViewport && !interior) {\n      target.style.position = 'fixed';\n      if (position.dropUp) {\n        target.style.bottom = `calc(100% - ${triggerBox.top}px)`;\n      } else {\n        target.style.top = `${triggerBox.bottom}px`;\n      }\n      if (position.dropLeft) {\n        target.style.left = `calc(${triggerBox.right}px - ${position.width})`;\n      } else {\n        target.style.left = `${triggerBox.left}px`;\n      }\n      // Keep track of the initial dropdown position and direction.\n      // Dropdown direction doesn't need to change as the user scrolls, just needs to stay attached to the trigger.\n      fixedPosition.current = position;\n      return;\n    }\n\n    // For an interior dropdown (the fly out) we need exact values for positioning\n    // and classes are not enough\n    // usage of relative position is impossible due to overwrite of overflow-x\n    if (interior && isInteriorPosition(position)) {\n      if (position.dropUp) {\n        target.style.bottom = position.bottom;\n      } else {\n        target.style.top = position.top;\n      }\n      target.style.left = position.left;\n    }\n\n    if (position.dropUp && position.dropLeft) {\n      setPosition('top-left');\n    } else if (position.dropUp) {\n      setPosition('top-right');\n    } else if (position.dropLeft) {\n      setPosition('bottom-left');\n    } else {\n      setPosition('bottom-right');\n    }\n  };\n\n  useLayoutEffect(() => {\n    const onDropdownOpen = () => {\n      if (open && dropdownRef.current && triggerRef.current && verticalContainerRef.current) {\n        // calculate scroll width only for dropdowns that has a scrollbar and ignore it for date picker components\n        if (scrollable) {\n          dropdownRef.current.classList.add(styles.nowrap);\n        }\n        setDropdownPosition(\n          ...calculatePosition(\n            dropdownRef.current,\n            triggerRef.current,\n            verticalContainerRef.current,\n            interior,\n            expandToViewport,\n            preferCenter,\n            stretchWidth,\n            stretchHeight,\n            isMobile,\n            minWidth\n          ),\n          dropdownRef.current,\n          verticalContainerRef.current\n        );\n        if (scrollable) {\n          dropdownRef.current.classList.remove(styles.nowrap);\n        }\n      }\n    };\n    onDropdownOpen();\n\n    if (open) {\n      // window may scroll when dropdown opens, for example when soft keyboard shows up\n      window.addEventListener('scroll', onDropdownOpen);\n      // only listen to window scroll within very short time after the dropdown opens\n      // do not want to interfere dropdown position on scroll afterwards\n      const timeoutId = setTimeout(() => {\n        window.removeEventListener('scroll', onDropdownOpen);\n      }, 500);\n\n      return () => {\n        clearTimeout(timeoutId);\n        window.removeEventListener('scroll', onDropdownOpen);\n      };\n    }\n    // See AWSUI-13040\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [open, dropdownRef, triggerRef, verticalContainerRef, interior, stretchWidth, isMobile]);\n\n  // subscribe to outside click\n  useEffect(() => {\n    if (!open) {\n      return;\n    }\n    const clickListener = (e: MouseEvent) => {\n      if (!dropdownRef.current?.contains(e.target as Node)) {\n        fireNonCancelableEvent(onDropdownClose);\n      }\n    };\n\n    /*\n     * This small delay allows the event that opened the dropdown to\n     * finish bubbling, so that it is not immediately captured here.\n     */\n    const timeout = setTimeout(() => {\n      window.addEventListener('click', clickListener);\n    }, 0);\n\n    return () => {\n      clearTimeout(timeout);\n      window.removeEventListener('click', clickListener);\n    };\n  }, [open, onDropdownClose]);\n\n  // sync dropdown position on scroll and resize\n  useLayoutEffect(() => {\n    if (!expandToViewport || !open) {\n      return;\n    }\n    const updateDropdownPosition = () => {\n      if (triggerRef.current && dropdownRef.current && verticalContainerRef.current) {\n        const triggerRect = triggerRef.current.getBoundingClientRect();\n        const target = dropdownRef.current;\n        if (fixedPosition.current) {\n          if (fixedPosition.current.dropUp) {\n            dropdownRef.current.style.bottom = `calc(100% - ${triggerRect.top}px)`;\n          } else {\n            target.style.top = `${triggerRect.bottom}px`;\n          }\n          if (fixedPosition.current.dropLeft) {\n            target.style.left = `calc(${triggerRect.right}px - ${fixedPosition.current.width})`;\n          } else {\n            target.style.left = `${triggerRect.left}px`;\n          }\n        }\n      }\n    };\n\n    updateDropdownPosition();\n\n    window.addEventListener('scroll', updateDropdownPosition, true);\n    window.addEventListener('resize', updateDropdownPosition, true);\n    return () => {\n      window.removeEventListener('scroll', updateDropdownPosition, true);\n      window.removeEventListener('resize', updateDropdownPosition, true);\n    };\n  }, [open, expandToViewport]);\n\n  return (\n    <div\n      className={clsx(\n        styles.root,\n        interior && styles.interior,\n        stretchTriggerHeight && styles['stretch-trigger-height']\n      )}\n    >\n      <div className={clsx(stretchTriggerHeight && styles['stretch-trigger-height'])} ref={triggerRef}>\n        {trigger}\n      </div>\n\n      <TabTrap\n        focusNextCallback={() => dropdownRef.current && getFirstFocusable(dropdownRef.current)?.focus()}\n        disabled={!open || !trapFocus}\n      />\n\n      <DropdownContainer renderWithPortal={expandToViewport && !interior} id={dropdownId} open={open}>\n        <Transition in={open ?? false} exit={false}>\n          {(state, ref) => (\n            <div onBlur={event => trapFocus && event.stopPropagation()}>\n              <TabTrap\n                focusNextCallback={() => triggerRef.current && getLastFocusable(triggerRef.current)?.focus()}\n                disabled={!open || !trapFocus}\n              />\n\n              <TransitionContent\n                state={state}\n                transitionRef={ref}\n                dropdownClasses={dropdownClasses}\n                open={open}\n                stretchWidth={stretchWidth}\n                interior={interior}\n                header={header}\n                hasContent={hasContent}\n                expandToViewport={expandToViewport}\n                footer={footer}\n                onMouseDown={onMouseDown}\n                isRefresh={isRefresh}\n                dropdownRef={dropdownRef}\n                verticalContainerRef={verticalContainerRef}\n                position={position}\n              >\n                {children}\n              </TransitionContent>\n\n              <TabTrap\n                focusNextCallback={() => triggerRef.current && getFirstFocusable(triggerRef.current)?.focus()}\n                disabled={!open || !trapFocus}\n              />\n            </div>\n          )}\n        </Transition>\n      </DropdownContainer>\n    </div>\n  );\n};\n\nconst isInteriorPosition = (\n  position: DropdownPosition | InteriorDropdownPosition\n): position is InteriorDropdownPosition => (position as InteriorDropdownPosition).bottom !== undefined;\n\nexport default Dropdown;\n"]},"metadata":{},"sourceType":"module"}