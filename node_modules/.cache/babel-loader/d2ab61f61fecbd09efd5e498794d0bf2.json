{"ast":null,"code":"import { __assign, __rest } from \"tslib\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport { getBaseProps } from '../internal/base-component';\nimport { fireCancelableEvent, isPlainLeftClick } from '../internal/events';\nimport VisualContext from '../internal/components/visual-context';\nimport Portal from '../internal/components/portal';\nimport useFocusVisible from '../internal/hooks/focus-visible';\nimport { useEffectOnUpdate } from '../internal/hooks/use-effect-on-update';\nimport { useTopNavigation } from './use-top-navigation.js';\nimport Utility from './parts/utility';\nimport OverflowMenu from './parts/overflow-menu';\nimport { ButtonTrigger } from '../internal/components/menu-dropdown';\nimport styles from './styles.css.js';\nimport { checkSafeUrl } from '../internal/utils/check-safe-url';\nexport default function InternalTopNavigation(_a) {\n  var __internalRootRef = _a.__internalRootRef,\n      identity = _a.identity,\n      i18nStrings = _a.i18nStrings,\n      utilities = _a.utilities,\n      search = _a.search,\n      restProps = __rest(_a, [\"__internalRootRef\", \"identity\", \"i18nStrings\", \"utilities\", \"search\"]);\n\n  checkSafeUrl('TopNavigation', identity.href);\n  var baseProps = getBaseProps(restProps);\n\n  var _b = useTopNavigation({\n    identity: identity,\n    search: search,\n    utilities: utilities\n  }),\n      mainRef = _b.mainRef,\n      virtualRef = _b.virtualRef,\n      breakpoint = _b.breakpoint,\n      responsiveState = _b.responsiveState,\n      isSearchExpanded = _b.isSearchExpanded,\n      onSearchUtilityClick = _b.onSearchUtilityClick;\n\n  var _c = useState(false),\n      overflowMenuOpen = _c[0],\n      setOverflowMenuOpen = _c[1];\n\n  var overflowMenuTriggerRef = useRef(null);\n  var isNarrowViewport = breakpoint === 'default';\n  var isMediumViewport = breakpoint === 'xxs';\n  var isLargeViewport = breakpoint === 's';\n\n  var onIdentityClick = function (event) {\n    if (isPlainLeftClick(event)) {\n      fireCancelableEvent(identity.onFollow, {}, event);\n    }\n  };\n\n  var toggleOverflowMenu = function () {\n    setOverflowMenuOpen(function (overflowMenuOpen) {\n      return !overflowMenuOpen;\n    });\n  };\n\n  var focusVisible = useFocusVisible();\n  var menuTriggerVisible = !isSearchExpanded && responsiveState.hideUtilities;\n  useEffect(function () {\n    setOverflowMenuOpen(false);\n  }, [menuTriggerVisible]);\n  useEffectOnUpdate(function () {\n    var _a;\n\n    if (!overflowMenuOpen) {\n      (_a = overflowMenuTriggerRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n  }, [overflowMenuOpen]); // Render the top nav twice; once as the top nav that users can see, and another\n  // \"virtual\" top nav used just for calculations. The virtual top nav doesn't react to\n  // layout changes and renders two sets of utilities: one with labels and one without.\n\n  var content = function (isVirtual) {\n    var _a, _b, _c, _d;\n\n    var _e, _f;\n\n    var Wrapper = isVirtual ? 'div' : 'header';\n    var showIdentity = isVirtual || !isSearchExpanded;\n    var showTitle = isVirtual || !responsiveState.hideTitle;\n    var showSearchSlot = search && (isVirtual || !responsiveState.hideSearch || isSearchExpanded);\n    var showSearchUtility = isVirtual || search && responsiveState.hideSearch;\n    var showUtilities = isVirtual || !isSearchExpanded;\n    var showMenuTrigger = isVirtual || menuTriggerVisible;\n    return React.createElement(Wrapper, {\n      ref: isVirtual ? virtualRef : mainRef,\n      \"aria-hidden\": isVirtual ? true : undefined,\n      // Wrapper is an alias for \"div\" or \"header\".\n      // eslint-disable-next-line react/forbid-component-props\n      className: clsx(styles['top-navigation'], (_a = {}, _a[styles.virtual] = isVirtual, _a[styles.hidden] = isVirtual, _a[styles.narrow] = isNarrowViewport, _a[styles.medium] = isMediumViewport, _a))\n    }, React.createElement(\"div\", {\n      className: styles['padding-box']\n    }, showIdentity && React.createElement(\"div\", {\n      className: clsx(styles.identity, !identity.logo && styles['no-logo'])\n    }, React.createElement(\"a\", __assign({}, focusVisible, {\n      className: styles['identity-link'],\n      href: identity.href,\n      onClick: onIdentityClick\n    }), identity.logo && React.createElement(\"img\", {\n      role: \"img\",\n      src: (_e = identity.logo) === null || _e === void 0 ? void 0 : _e.src,\n      alt: (_f = identity.logo) === null || _f === void 0 ? void 0 : _f.alt,\n      className: clsx(styles.logo, (_b = {}, _b[styles.narrow] = isNarrowViewport, _b))\n    }), showTitle && React.createElement(\"span\", {\n      className: styles.title\n    }, identity.title))), React.createElement(\"div\", {\n      className: styles.inputs\n    }, showSearchSlot && React.createElement(\"div\", {\n      className: clsx(styles.search, !isVirtual && isSearchExpanded && styles['search-expanded'])\n    }, search)), React.createElement(\"div\", {\n      className: styles.utilities\n    }, showSearchUtility && React.createElement(\"div\", {\n      className: clsx(styles['utility-wrapper'], styles['utility-type-button'], styles['utility-type-button-link'], (_c = {}, _c[styles.narrow] = isNarrowViewport, _c[styles.medium] = isMediumViewport, _c)),\n      \"data-utility-special\": \"search\"\n    }, React.createElement(Utility, {\n      hideText: true,\n      definition: {\n        type: 'button',\n        iconName: isSearchExpanded ? 'close' : 'search',\n        ariaLabel: isSearchExpanded ? i18nStrings.searchDismissIconAriaLabel : i18nStrings.searchIconAriaLabel,\n        onClick: onSearchUtilityClick\n      }\n    })), showUtilities && utilities.filter(function (_utility, i) {\n      return isVirtual || !responsiveState.hideUtilities || responsiveState.hideUtilities.indexOf(i) === -1;\n    }).map(function (utility, i) {\n      var _a;\n\n      var _b;\n\n      var hideText = !!responsiveState.hideUtilityText;\n      var isLast = (isVirtual || !showMenuTrigger) && i === utilities.length - 1;\n      var offsetRight = isLast && isLargeViewport ? 'xxl' : isLast ? 'l' : undefined;\n      return React.createElement(\"div\", {\n        key: i,\n        className: clsx(styles['utility-wrapper'], styles[\"utility-type-\".concat(utility.type)], utility.type === 'button' && styles[\"utility-type-button-\".concat((_b = utility.variant) !== null && _b !== void 0 ? _b : 'link')], (_a = {}, _a[styles.narrow] = isNarrowViewport, _a[styles.medium] = isMediumViewport, _a)),\n        \"data-utility-index\": i,\n        \"data-utility-hide\": \"\".concat(hideText)\n      }, React.createElement(Utility, {\n        hideText: hideText,\n        definition: utility,\n        offsetRight: offsetRight\n      }));\n    }), isVirtual && utilities.map(function (utility, i) {\n      var _a;\n\n      var _b;\n\n      var hideText = !responsiveState.hideUtilityText;\n      var isLast = !showMenuTrigger && i === utilities.length - 1;\n      var offsetRight = isLast && isLargeViewport ? 'xxl' : isLast ? 'l' : undefined;\n      return React.createElement(\"div\", {\n        key: i,\n        className: clsx(styles['utility-wrapper'], styles[\"utility-type-\".concat(utility.type)], utility.type === 'button' && styles[\"utility-type-button-\".concat((_b = utility.variant) !== null && _b !== void 0 ? _b : 'link')], (_a = {}, _a[styles.narrow] = isNarrowViewport, _a[styles.medium] = isMediumViewport, _a)),\n        \"data-utility-index\": i,\n        \"data-utility-hide\": \"\".concat(hideText)\n      }, React.createElement(Utility, {\n        hideText: hideText,\n        definition: utility,\n        offsetRight: offsetRight\n      }));\n    }), showMenuTrigger && React.createElement(\"div\", {\n      className: clsx(styles['utility-wrapper'], styles['utility-type-menu-dropdown'], (_d = {}, _d[styles.narrow] = isNarrowViewport, _d[styles.medium] = isMediumViewport, _d)),\n      \"data-utility-special\": \"menu-trigger\"\n    }, React.createElement(ButtonTrigger, {\n      expanded: overflowMenuOpen,\n      onClick: toggleOverflowMenu,\n      offsetRight: \"l\",\n      ref: !isVirtual ? overflowMenuTriggerRef : undefined\n    }, i18nStrings.overflowMenuTriggerText)))));\n  };\n\n  return React.createElement(\"div\", __assign({}, baseProps, {\n    ref: __internalRootRef\n  }), React.createElement(VisualContext, {\n    contextName: \"top-navigation\"\n  }, content(false), React.createElement(Portal, null, content(true)), menuTriggerVisible && overflowMenuOpen && React.createElement(\"div\", {\n    className: styles['overflow-menu-drawer']\n  }, React.createElement(OverflowMenu, {\n    headerText: i18nStrings.overflowMenuTitleText,\n    dismissIconAriaLabel: i18nStrings.overflowMenuDismissIconAriaLabel,\n    backIconAriaLabel: i18nStrings.overflowMenuBackIconAriaLabel,\n    items: utilities.filter(function (utility, i) {\n      return (!responsiveState.hideUtilities || responsiveState.hideUtilities.indexOf(i) !== -1) && !utility.disableUtilityCollapse;\n    }),\n    onClose: toggleOverflowMenu\n  }))));\n}","map":{"version":3,"mappings":"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","names":["React","useEffect","useRef","useState","clsx","getBaseProps","fireCancelableEvent","isPlainLeftClick","VisualContext","Portal","useFocusVisible","useEffectOnUpdate","useTopNavigation","Utility","OverflowMenu","ButtonTrigger","styles","checkSafeUrl","InternalTopNavigation","_a","identity","i18nStrings","utilities","search","restProps","href","baseProps","mainRef","virtualRef","breakpoint","responsiveState","isSearchExpanded","onSearchUtilityClick","overflowMenuOpen","setOverflowMenuOpen","overflowMenuTriggerRef","isNarrowViewport","isMediumViewport","isLargeViewport","onIdentityClick","event","onFollow","toggleOverflowMenu","focusVisible","menuTriggerVisible","hideUtilities","current","focus","content","isVirtual","Wrapper","showIdentity","showTitle","hideTitle","showSearchSlot","hideSearch","showSearchUtility","showUtilities","showMenuTrigger","ref","undefined","className","virtual","hidden","narrow","medium","logo","onClick","role","src","_e","alt","_f","_b","title","inputs","_c","hideText","definition","type","iconName","ariaLabel","searchDismissIconAriaLabel","searchIconAriaLabel","filter","_utility","i","indexOf","map","utility","hideUtilityText","isLast","length","offsetRight","key","variant","_d","expanded","overflowMenuTriggerText","__internalRootRef","contextName","headerText","overflowMenuTitleText","dismissIconAriaLabel","overflowMenuDismissIconAriaLabel","backIconAriaLabel","overflowMenuBackIconAriaLabel","items","disableUtilityCollapse","onClose"],"sourceRoot":"","sources":["../../../src/top-navigation/internal.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\nimport clsx from 'clsx';\n\nimport { InternalBaseComponentProps } from '../internal/hooks/use-base-component';\nimport { getBaseProps } from '../internal/base-component';\nimport { fireCancelableEvent, isPlainLeftClick } from '../internal/events';\nimport VisualContext from '../internal/components/visual-context';\nimport Portal from '../internal/components/portal';\nimport useFocusVisible from '../internal/hooks/focus-visible';\nimport { useEffectOnUpdate } from '../internal/hooks/use-effect-on-update';\n\nimport { TopNavigationProps } from './interfaces';\nimport { useTopNavigation } from './use-top-navigation.js';\nimport Utility from './parts/utility';\nimport OverflowMenu from './parts/overflow-menu';\nimport { ButtonTrigger } from '../internal/components/menu-dropdown';\n\nimport styles from './styles.css.js';\nimport { checkSafeUrl } from '../internal/utils/check-safe-url';\nimport { SomeRequired } from '../internal/types';\n\nexport type InternalTopNavigationProps = SomeRequired<TopNavigationProps, 'utilities'> & InternalBaseComponentProps;\n\nexport default function InternalTopNavigation({\n  __internalRootRef,\n  identity,\n  i18nStrings,\n  utilities,\n  search,\n  ...restProps\n}: InternalTopNavigationProps) {\n  checkSafeUrl('TopNavigation', identity.href);\n  const baseProps = getBaseProps(restProps);\n  const { mainRef, virtualRef, breakpoint, responsiveState, isSearchExpanded, onSearchUtilityClick } = useTopNavigation(\n    { identity, search, utilities }\n  );\n  const [overflowMenuOpen, setOverflowMenuOpen] = useState(false);\n  const overflowMenuTriggerRef = useRef<HTMLButtonElement>(null);\n  const isNarrowViewport = breakpoint === 'default';\n  const isMediumViewport = breakpoint === 'xxs';\n  const isLargeViewport = breakpoint === 's';\n\n  const onIdentityClick = (event: React.MouseEvent) => {\n    if (isPlainLeftClick(event)) {\n      fireCancelableEvent(identity.onFollow, {}, event);\n    }\n  };\n\n  const toggleOverflowMenu = () => {\n    setOverflowMenuOpen(overflowMenuOpen => !overflowMenuOpen);\n  };\n\n  const focusVisible = useFocusVisible();\n  const menuTriggerVisible = !isSearchExpanded && responsiveState.hideUtilities;\n\n  useEffect(() => {\n    setOverflowMenuOpen(false);\n  }, [menuTriggerVisible]);\n\n  useEffectOnUpdate(() => {\n    if (!overflowMenuOpen) {\n      overflowMenuTriggerRef.current?.focus();\n    }\n  }, [overflowMenuOpen]);\n\n  // Render the top nav twice; once as the top nav that users can see, and another\n  // \"virtual\" top nav used just for calculations. The virtual top nav doesn't react to\n  // layout changes and renders two sets of utilities: one with labels and one without.\n  const content = (isVirtual: boolean) => {\n    const Wrapper = isVirtual ? 'div' : 'header';\n    const showIdentity = isVirtual || !isSearchExpanded;\n    const showTitle = isVirtual || !responsiveState.hideTitle;\n    const showSearchSlot = search && (isVirtual || !responsiveState.hideSearch || isSearchExpanded);\n    const showSearchUtility = isVirtual || (search && responsiveState.hideSearch);\n    const showUtilities = isVirtual || !isSearchExpanded;\n    const showMenuTrigger = isVirtual || menuTriggerVisible;\n\n    return (\n      <Wrapper\n        ref={isVirtual ? virtualRef : mainRef}\n        aria-hidden={isVirtual ? true : undefined}\n        // Wrapper is an alias for \"div\" or \"header\".\n        // eslint-disable-next-line react/forbid-component-props\n        className={clsx(styles['top-navigation'], {\n          [styles.virtual]: isVirtual,\n          [styles.hidden]: isVirtual,\n          [styles.narrow]: isNarrowViewport,\n          [styles.medium]: isMediumViewport,\n        })}\n      >\n        <div className={styles['padding-box']}>\n          {showIdentity && (\n            <div className={clsx(styles.identity, !identity.logo && styles['no-logo'])}>\n              <a {...focusVisible} className={styles['identity-link']} href={identity.href} onClick={onIdentityClick}>\n                {identity.logo && (\n                  <img\n                    role=\"img\"\n                    src={identity.logo?.src}\n                    alt={identity.logo?.alt}\n                    className={clsx(styles.logo, {\n                      [styles.narrow]: isNarrowViewport,\n                    })}\n                  />\n                )}\n                {showTitle && <span className={styles.title}>{identity.title}</span>}\n              </a>\n            </div>\n          )}\n\n          <div className={styles.inputs}>\n            {showSearchSlot && (\n              <div className={clsx(styles.search, !isVirtual && isSearchExpanded && styles['search-expanded'])}>\n                {search}\n              </div>\n            )}\n          </div>\n\n          <div className={styles.utilities}>\n            {showSearchUtility && (\n              <div\n                className={clsx(\n                  styles['utility-wrapper'],\n                  styles['utility-type-button'],\n                  styles['utility-type-button-link'],\n                  {\n                    [styles.narrow]: isNarrowViewport,\n                    [styles.medium]: isMediumViewport,\n                  }\n                )}\n                data-utility-special=\"search\"\n              >\n                <Utility\n                  hideText={true}\n                  definition={{\n                    type: 'button',\n                    iconName: isSearchExpanded ? 'close' : 'search',\n                    ariaLabel: isSearchExpanded\n                      ? i18nStrings.searchDismissIconAriaLabel\n                      : i18nStrings.searchIconAriaLabel,\n                    onClick: onSearchUtilityClick,\n                  }}\n                />\n              </div>\n            )}\n\n            {showUtilities &&\n              utilities\n                .filter(\n                  (_utility, i) =>\n                    isVirtual || !responsiveState.hideUtilities || responsiveState.hideUtilities.indexOf(i) === -1\n                )\n                .map((utility, i) => {\n                  const hideText = !!responsiveState.hideUtilityText;\n                  const isLast = (isVirtual || !showMenuTrigger) && i === utilities.length - 1;\n                  const offsetRight = isLast && isLargeViewport ? 'xxl' : isLast ? 'l' : undefined;\n\n                  return (\n                    <div\n                      key={i}\n                      className={clsx(\n                        styles['utility-wrapper'],\n                        styles[`utility-type-${utility.type}`],\n                        utility.type === 'button' && styles[`utility-type-button-${utility.variant ?? 'link'}`],\n                        {\n                          [styles.narrow]: isNarrowViewport,\n                          [styles.medium]: isMediumViewport,\n                        }\n                      )}\n                      data-utility-index={i}\n                      data-utility-hide={`${hideText}`}\n                    >\n                      <Utility hideText={hideText} definition={utility} offsetRight={offsetRight} />\n                    </div>\n                  );\n                })}\n\n            {isVirtual &&\n              utilities.map((utility, i) => {\n                const hideText = !responsiveState.hideUtilityText;\n                const isLast = !showMenuTrigger && i === utilities.length - 1;\n                const offsetRight = isLast && isLargeViewport ? 'xxl' : isLast ? 'l' : undefined;\n\n                return (\n                  <div\n                    key={i}\n                    className={clsx(\n                      styles['utility-wrapper'],\n                      styles[`utility-type-${utility.type}`],\n                      utility.type === 'button' && styles[`utility-type-button-${utility.variant ?? 'link'}`],\n                      {\n                        [styles.narrow]: isNarrowViewport,\n                        [styles.medium]: isMediumViewport,\n                      }\n                    )}\n                    data-utility-index={i}\n                    data-utility-hide={`${hideText}`}\n                  >\n                    <Utility hideText={hideText} definition={utility} offsetRight={offsetRight} />\n                  </div>\n                );\n              })}\n\n            {showMenuTrigger && (\n              <div\n                className={clsx(styles['utility-wrapper'], styles['utility-type-menu-dropdown'], {\n                  [styles.narrow]: isNarrowViewport,\n                  [styles.medium]: isMediumViewport,\n                })}\n                data-utility-special=\"menu-trigger\"\n              >\n                <ButtonTrigger\n                  expanded={overflowMenuOpen}\n                  onClick={toggleOverflowMenu}\n                  offsetRight=\"l\"\n                  ref={!isVirtual ? overflowMenuTriggerRef : undefined}\n                >\n                  {i18nStrings.overflowMenuTriggerText}\n                </ButtonTrigger>\n              </div>\n            )}\n          </div>\n        </div>\n      </Wrapper>\n    );\n  };\n\n  return (\n    <div {...baseProps} ref={__internalRootRef}>\n      <VisualContext contextName=\"top-navigation\">\n        {content(false)}\n        <Portal>{content(true)}</Portal>\n        {menuTriggerVisible && overflowMenuOpen && (\n          <div className={styles['overflow-menu-drawer']}>\n            <OverflowMenu\n              headerText={i18nStrings.overflowMenuTitleText}\n              dismissIconAriaLabel={i18nStrings.overflowMenuDismissIconAriaLabel}\n              backIconAriaLabel={i18nStrings.overflowMenuBackIconAriaLabel}\n              items={utilities.filter(\n                (utility, i) =>\n                  (!responsiveState.hideUtilities || responsiveState.hideUtilities.indexOf(i) !== -1) &&\n                  !utility.disableUtilityCollapse\n              )}\n              onClose={toggleOverflowMenu}\n            />\n          </div>\n        )}\n      </VisualContext>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}