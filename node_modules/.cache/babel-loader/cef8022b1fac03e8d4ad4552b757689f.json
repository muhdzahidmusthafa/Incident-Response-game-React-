{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport FocusLock from 'react-focus-lock';\nimport { ResizableBox } from 'react-resizable';\nimport { KeyCode } from '../internal/keycode';\nimport { scrollElementIntoView } from '../internal/utils/scrollable-containers';\nimport { InternalButton } from '../button/internal';\nimport handler from './resize-handler';\nimport styles from './styles.css.js';\nvar ANNOTATION_ITEM_HEIGHT = 31;\nvar PANE_ANNOTATIONS_PADDING = 12;\nvar MIN_HEIGHT = 3 * ANNOTATION_ITEM_HEIGHT + 2 * PANE_ANNOTATIONS_PADDING;\nexport var Pane = function (_a) {\n  var id = _a.id,\n      visible = _a.visible,\n      annotations = _a.annotations,\n      highlighted = _a.highlighted,\n      onAllowlist = _a.onAllowlist,\n      onClose = _a.onClose,\n      onAnnotationClick = _a.onAnnotationClick,\n      onAnnotationClear = _a.onAnnotationClear,\n      cursorPositionLabel = _a.cursorPositionLabel,\n      closeButtonAriaLabel = _a.closeButtonAriaLabel;\n  var listRef = useRef(null);\n\n  var _b = useState(false),\n      isFocusTrapActive = _b[0],\n      setFocusTrapActive = _b[1];\n\n  useEffect(function () {\n    var _a;\n\n    if (!highlighted) {\n      return;\n    }\n\n    var row = highlighted.row,\n        column = highlighted.column;\n    var highlightedAnnotationIndex = annotations.indexOf(annotations.filter(function (a) {\n      return a.row === row && a.column === column;\n    })[0]);\n\n    if (highlightedAnnotationIndex > -1) {\n      var errorItem = (_a = listRef.current) === null || _a === void 0 ? void 0 : _a.children[highlightedAnnotationIndex];\n      scrollElementIntoView(errorItem);\n    }\n  }, [highlighted, annotations]);\n\n  var onItemFocus = function () {\n    setFocusTrapActive(true);\n    onAnnotationClear();\n  };\n\n  var onItemClick = function (annotation) {\n    setFocusTrapActive(false);\n    onAnnotationClick(annotation);\n  };\n\n  var onItemKeyDown = function (annotation, event) {\n    if (event.keyCode === KeyCode.enter || event.keyCode === KeyCode.space) {\n      event.preventDefault();\n      setFocusTrapActive(false);\n      onAnnotationClick(annotation);\n    }\n  };\n\n  var onEscKeyDown = function (event) {\n    if (event.keyCode === KeyCode.escape) {\n      event.preventDefault();\n      setFocusTrapActive(false);\n      onClose();\n    }\n  };\n\n  if (!visible) {\n    return null;\n  }\n\n  return React.createElement(\"div\", {\n    id: id,\n    className: styles.pane,\n    onKeyDown: onEscKeyDown,\n    role: \"tabpanel\"\n  }, React.createElement(ResizableBox, {\n    className: styles['resizable-box'],\n    width: Infinity,\n    height: MIN_HEIGHT,\n    minConstraints: [Infinity, MIN_HEIGHT],\n    axis: \"y\",\n    handle: handler\n  }, React.createElement(FocusLock, {\n    disabled: !isFocusTrapActive,\n    className: styles['focus-lock'],\n    autoFocus: false,\n    returnFocus: false,\n    whiteList: onAllowlist\n  }, React.createElement(\"div\", {\n    className: styles.pane__list,\n    tabIndex: -1\n  }, React.createElement(\"table\", {\n    className: styles.pane__table,\n    role: \"presentation\"\n  }, React.createElement(\"colgroup\", null, React.createElement(\"col\", {\n    style: {\n      width: 1\n    }\n    /* shrink to fit content */\n\n  }), React.createElement(\"col\", {\n    style: {\n      width: 'auto'\n    }\n  })), React.createElement(\"tbody\", {\n    ref: listRef\n  }, annotations.map(function (annotation, i) {\n    var _a;\n\n    return React.createElement(\"tr\", {\n      key: i,\n      className: clsx(styles.pane__item, (_a = {}, _a[styles['pane__item--highlighted']] = annotation === highlighted, _a)),\n      onFocus: onItemFocus,\n      onMouseOver: onAnnotationClear,\n      onClick: onItemClick.bind(null, annotation),\n      onKeyDown: onItemKeyDown.bind(null, annotation),\n      tabIndex: 0,\n      role: \"link\"\n    }, React.createElement(\"td\", {\n      className: clsx(styles.pane__location, styles.pane__cell),\n      tabIndex: -1\n    }, cursorPositionLabel((annotation.row || 0) + 1, (annotation.column || 0) + 1)), React.createElement(\"td\", {\n      className: clsx(styles.pane__description, styles.pane__cell),\n      tabIndex: -1\n    }, annotation.text));\n  })))), React.createElement(\"div\", {\n    className: styles['pane__close-container']\n  }, React.createElement(InternalButton, {\n    formAction: \"none\",\n    variant: \"icon\",\n    iconName: \"close\",\n    onClick: onClose,\n    ariaLabel: closeButtonAriaLabel\n  })))));\n};","map":{"version":3,"mappings":"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","names":["React","useEffect","useRef","useState","clsx","FocusLock","ResizableBox","KeyCode","scrollElementIntoView","InternalButton","handler","styles","ANNOTATION_ITEM_HEIGHT","PANE_ANNOTATIONS_PADDING","MIN_HEIGHT","Pane","_a","id","visible","annotations","highlighted","onAllowlist","onClose","onAnnotationClick","onAnnotationClear","cursorPositionLabel","closeButtonAriaLabel","listRef","isFocusTrapActive","setFocusTrapActive","column","highlightedAnnotationIndex","indexOf","filter","row","a","errorItem","current","children","onItemFocus","onItemClick","annotation","onItemKeyDown","event","keyCode","enter","space","preventDefault","onEscKeyDown","escape","className","pane","onKeyDown","role","width","Infinity","height","minConstraints","axis","handle","disabled","autoFocus","returnFocus","whiteList","pane__list","tabIndex","pane__table","style","ref","map","i","key","pane__item","onFocus","onMouseOver","onClick","bind","pane__location","pane__cell","pane__description","text","formAction","variant","iconName","ariaLabel"],"sourceRoot":"","sources":["../../../src/code-editor/pane.tsx"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect, useRef, useState } from 'react';\nimport clsx from 'clsx';\nimport FocusLock from 'react-focus-lock';\nimport { ResizableBox } from 'react-resizable';\nimport { Ace } from 'ace-builds';\n\nimport { KeyCode } from '../internal/keycode';\nimport { scrollElementIntoView } from '../internal/utils/scrollable-containers';\n\nimport { InternalButton } from '../button/internal';\nimport handler from './resize-handler';\n\nimport styles from './styles.css.js';\n\nconst ANNOTATION_ITEM_HEIGHT = 31;\nconst PANE_ANNOTATIONS_PADDING = 12;\nconst MIN_HEIGHT = 3 * ANNOTATION_ITEM_HEIGHT + 2 * PANE_ANNOTATIONS_PADDING;\n\nexport interface PaneProps {\n  id: string;\n\n  visible: boolean;\n  annotations: Ace.Annotation[];\n  highlighted?: Ace.Annotation;\n\n  cursorPositionLabel: (row: number, column: number) => string;\n  closeButtonAriaLabel: string;\n\n  onAllowlist: (activeElement: HTMLElement) => boolean;\n  onClose: () => void;\n  onAnnotationClick: (annotation: Ace.Annotation) => void;\n  onAnnotationClear: () => void;\n}\n\nexport const Pane = ({\n  id,\n  visible,\n  annotations,\n  highlighted,\n  onAllowlist,\n  onClose,\n  onAnnotationClick,\n  onAnnotationClear,\n  cursorPositionLabel,\n  closeButtonAriaLabel,\n}: PaneProps) => {\n  const listRef = useRef<HTMLTableSectionElement>(null);\n  const [isFocusTrapActive, setFocusTrapActive] = useState(false);\n\n  useEffect(() => {\n    if (!highlighted) {\n      return;\n    }\n    const { row, column } = highlighted;\n    const highlightedAnnotationIndex = annotations.indexOf(\n      annotations.filter(a => a.row === row && a.column === column)[0]\n    );\n\n    if (highlightedAnnotationIndex > -1) {\n      const errorItem = listRef.current?.children[highlightedAnnotationIndex] as HTMLElement | undefined;\n      scrollElementIntoView(errorItem);\n    }\n  }, [highlighted, annotations]);\n\n  const onItemFocus = () => {\n    setFocusTrapActive(true);\n    onAnnotationClear();\n  };\n\n  const onItemClick = (annotation: Ace.Annotation) => {\n    setFocusTrapActive(false);\n    onAnnotationClick(annotation);\n  };\n  const onItemKeyDown = (annotation: Ace.Annotation, event: React.KeyboardEvent) => {\n    if (event.keyCode === KeyCode.enter || event.keyCode === KeyCode.space) {\n      event.preventDefault();\n      setFocusTrapActive(false);\n      onAnnotationClick(annotation);\n    }\n  };\n\n  const onEscKeyDown = (event: React.KeyboardEvent) => {\n    if (event.keyCode === KeyCode.escape) {\n      event.preventDefault();\n      setFocusTrapActive(false);\n      onClose();\n    }\n  };\n\n  if (!visible) {\n    return null;\n  }\n\n  return (\n    <div id={id} className={styles.pane} onKeyDown={onEscKeyDown} role=\"tabpanel\">\n      <ResizableBox\n        className={styles['resizable-box']}\n        width={Infinity}\n        height={MIN_HEIGHT}\n        minConstraints={[Infinity, MIN_HEIGHT]}\n        axis=\"y\"\n        handle={handler}\n      >\n        <FocusLock\n          disabled={!isFocusTrapActive}\n          className={styles['focus-lock']}\n          autoFocus={false}\n          returnFocus={false}\n          whiteList={onAllowlist}\n        >\n          <div className={styles.pane__list} tabIndex={-1}>\n            <table className={styles.pane__table} role=\"presentation\">\n              <colgroup>\n                <col style={{ width: 1 } /* shrink to fit content */} />\n                <col style={{ width: 'auto' }} />\n              </colgroup>\n              <tbody ref={listRef}>\n                {annotations.map((annotation, i) => (\n                  <tr\n                    key={i}\n                    className={clsx(styles.pane__item, {\n                      [styles['pane__item--highlighted']]: annotation === highlighted,\n                    })}\n                    onFocus={onItemFocus}\n                    onMouseOver={onAnnotationClear}\n                    onClick={onItemClick.bind(null, annotation)}\n                    onKeyDown={onItemKeyDown.bind(null, annotation)}\n                    tabIndex={0}\n                    role=\"link\"\n                  >\n                    <td className={clsx(styles.pane__location, styles.pane__cell)} tabIndex={-1}>\n                      {cursorPositionLabel((annotation.row || 0) + 1, (annotation.column || 0) + 1)}\n                    </td>\n                    <td className={clsx(styles.pane__description, styles.pane__cell)} tabIndex={-1}>\n                      {annotation.text}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n          <div className={styles['pane__close-container']}>\n            <InternalButton\n              formAction=\"none\"\n              variant=\"icon\"\n              iconName=\"close\"\n              onClick={onClose}\n              ariaLabel={closeButtonAriaLabel}\n            />\n          </div>\n        </FocusLock>\n      </ResizableBox>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}