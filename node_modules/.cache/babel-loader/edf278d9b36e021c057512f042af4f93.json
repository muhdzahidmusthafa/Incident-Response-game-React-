{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useEffect } from 'react';\nimport { useStableEventHandler } from '../use-stable-event-handler';\nimport { createSingletonHandler } from '../use-singleton-handler';\nvar useMutationSingleton = createSingletonHandler(function (handler) {\n  var observer = new MutationObserver(function () {\n    return handler();\n  });\n  observer.observe(document.body, {\n    attributes: true,\n    subtree: true\n  });\n  return function () {\n    return observer.disconnect();\n  };\n});\nexport function useMutationObserver(elementRef, onChange) {\n  var handler = useStableEventHandler(function () {\n    if (elementRef.current) {\n      onChange(elementRef.current);\n    }\n  });\n  useMutationSingleton(handler);\n  useEffect(function () {\n    handler();\n  }, [handler]);\n}","map":{"version":3,"mappings":"AAAA;AACA;AACA,SAAgBA,SAAhB,QAAiC,OAAjC;AACA,SAASC,qBAAT,QAAsC,6BAAtC;AACA,SAASC,sBAAT,QAAuC,0BAAvC;AAEA,IAAMC,oBAAoB,GAAGD,sBAAsB,CAAO,mBAAO;EAC/D,IAAME,QAAQ,GAAG,IAAIC,gBAAJ,CAAqB;IAAM,cAAO,EAAP;EAAS,CAApC,CAAjB;EACAD,QAAQ,CAACE,OAAT,CAAiBC,QAAQ,CAACC,IAA1B,EAAgC;IAAEC,UAAU,EAAE,IAAd;IAAoBC,OAAO,EAAE;EAA7B,CAAhC;EACA,OAAO;IAAM,eAAQ,CAACC,UAAT;EAAqB,CAAlC;AACD,CAJkD,CAAnD;AAMA,OAAM,SAAUC,mBAAV,CACJC,UADI,EAEJC,QAFI,EAEoC;EAExC,IAAMC,OAAO,GAAGd,qBAAqB,CAAC;IACpC,IAAIY,UAAU,CAACG,OAAf,EAAwB;MACtBF,QAAQ,CAACD,UAAU,CAACG,OAAZ,CAAR;IACD;EACF,CAJoC,CAArC;EAKAb,oBAAoB,CAACY,OAAD,CAApB;EAEAf,SAAS,CAAC;IACRe,OAAO;EACR,CAFQ,EAEN,CAACA,OAAD,CAFM,CAAT;AAGD","names":["useEffect","useStableEventHandler","createSingletonHandler","useMutationSingleton","observer","MutationObserver","observe","document","body","attributes","subtree","disconnect","useMutationObserver","elementRef","onChange","handler","current"],"sourceRoot":"","sources":["../../../../../src/internal/hooks/use-mutation-observer/index.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useEffect } from 'react';\nimport { useStableEventHandler } from '../use-stable-event-handler';\nimport { createSingletonHandler } from '../use-singleton-handler';\n\nconst useMutationSingleton = createSingletonHandler<void>(handler => {\n  const observer = new MutationObserver(() => handler());\n  observer.observe(document.body, { attributes: true, subtree: true });\n  return () => observer.disconnect();\n});\n\nexport function useMutationObserver(\n  elementRef: React.RefObject<HTMLElement>,\n  onChange: (element: HTMLElement) => void\n) {\n  const handler = useStableEventHandler(() => {\n    if (elementRef.current) {\n      onChange(elementRef.current);\n    }\n  });\n  useMutationSingleton(handler);\n\n  useEffect(() => {\n    handler();\n  }, [handler]);\n}\n"]},"metadata":{},"sourceType":"module"}