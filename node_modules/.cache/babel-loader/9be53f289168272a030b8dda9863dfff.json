{"ast":null,"code":"import { __spreadArray } from \"tslib\"; // Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { useState, useMemo, useCallback } from 'react';\nimport { indexIncludes } from './utils';\nimport createItemsTree from './create-items-tree';\nimport moveHighlightOneStep from './move-highlight';\nexport default function useHighlightedMenu(_a) {\n  var items = _a.items,\n      hasExpandableGroups = _a.hasExpandableGroups,\n      _b = _a.isInRestrictedView,\n      isInRestrictedView = _b === void 0 ? false : _b;\n\n  var _c = useState([]),\n      targetIndex = _c[0],\n      setTargetIndex = _c[1];\n\n  var _d = useState([]),\n      expandedIndex = _d[0],\n      setExpandedIndex = _d[1];\n\n  var _e = useMemo(function () {\n    return createItemsTree(items);\n  }, [items]),\n      getItem = _e.getItem,\n      getItemIndex = _e.getItemIndex,\n      getSequentialIndex = _e.getSequentialIndex,\n      getParentIndex = _e.getParentIndex;\n\n  var targetItem = useMemo(function () {\n    return getItem(targetIndex);\n  }, [targetIndex, getItem]);\n  var isHighlighted = useCallback(function (item) {\n    var index = getItemIndex(item);\n    return indexIncludes(index, targetIndex);\n  }, [targetIndex, getItemIndex]);\n  var isExpanded = useCallback(function (group) {\n    var index = getItemIndex(group);\n    return indexIncludes(index, expandedIndex);\n  }, [expandedIndex, getItemIndex]);\n  var moveHighlight = useCallback(function (direction) {\n    var getNext = function (index) {\n      var nextIndex = getSequentialIndex(index, direction);\n      var item = getItem(nextIndex || [-1]);\n\n      if (!nextIndex || !item) {\n        return null;\n      }\n\n      var parentIndex = getParentIndex(item);\n      var parentItem = parentIndex && getItem(parentIndex);\n      return {\n        index: nextIndex,\n        item: item,\n        parent: parentItem || undefined\n      };\n    };\n\n    var nextIndex = moveHighlightOneStep({\n      startIndex: targetIndex,\n      expandedIndex: expandedIndex,\n      getNext: getNext,\n      hasExpandableGroups: hasExpandableGroups,\n      isInRestrictedView: isInRestrictedView\n    });\n\n    if (nextIndex) {\n      setTargetIndex(nextIndex);\n    }\n  }, [targetIndex, expandedIndex, getItem, getSequentialIndex, getParentIndex, hasExpandableGroups, isInRestrictedView]);\n  var highlightItem = useCallback(function (item) {\n    setTargetIndex(getItemIndex(item));\n  }, [getItemIndex]);\n  var expandGroup = useCallback(function (group) {\n    var groupIndex = group ? getItemIndex(group) : targetIndex;\n\n    var firstChildIndex = __spreadArray(__spreadArray([], groupIndex, true), [0], false); // move to the first child item unless in restricted mode\n\n\n    setTargetIndex(isInRestrictedView ? groupIndex : firstChildIndex);\n    setExpandedIndex(groupIndex);\n  }, [targetIndex, getItemIndex, isInRestrictedView]);\n  var collapseGroup = useCallback(function () {\n    if (expandedIndex.length > 0) {\n      setTargetIndex(expandedIndex);\n      setExpandedIndex(expandedIndex.slice(0, -1));\n    }\n  }, [expandedIndex]);\n  var reset = useCallback(function () {\n    setTargetIndex([]);\n    setExpandedIndex([]);\n  }, []);\n  return {\n    targetItem: targetItem,\n    isHighlighted: isHighlighted,\n    isExpanded: isExpanded,\n    moveHighlight: moveHighlight,\n    highlightItem: highlightItem,\n    expandGroup: expandGroup,\n    collapseGroup: collapseGroup,\n    reset: reset\n  };\n}","map":{"version":3,"mappings":"uCAAA;AACA;;AACA,SAASA,QAAT,EAAmBC,OAAnB,EAA4BC,WAA5B,QAA+C,OAA/C;AAEA,SAASC,aAAT,QAA8B,SAA9B;AAEA,OAAOC,eAAP,MAA2C,qBAA3C;AACA,OAAOC,oBAAP,MAAiC,kBAAjC;AAeA,eAAc,SAAUC,kBAAV,CAA6BC,EAA7B,EAIc;MAH1BC,KAAK;MACLC,mBAAmB;MACnBC;MAAAC,kBAAkB,mBAAG,KAAH,GAAQD;;EAEpB,SAAgCV,QAAQ,CAAY,EAAZ,CAAxC;EAAA,IAACY,WAAW,QAAZ;EAAA,IAAcC,cAAc,QAA5B;;EACA,SAAoCb,QAAQ,CAAY,EAAZ,CAA5C;EAAA,IAACc,aAAa,QAAd;EAAA,IAAgBC,gBAAgB,QAAhC;;EAEA,SAAgEd,OAAO,CAAC;IAAM,sBAAe,CAACO,KAAD,CAAf;EAAsB,CAA7B,EAA+B,CAACA,KAAD,CAA/B,CAAvE;EAAA,IAAEQ,OAAO,aAAT;EAAA,IAAWC,YAAY,kBAAvB;EAAA,IAAyBC,kBAAkB,wBAA3C;EAAA,IAA6CC,cAAc,oBAA3D;;EAEN,IAAMC,UAAU,GAAGnB,OAAO,CAAC;IAAM,cAAO,CAACW,WAAD,CAAP;EAAoB,CAA3B,EAA6B,CAACA,WAAD,EAAcI,OAAd,CAA7B,CAA1B;EAEA,IAAMK,aAAa,GAAGnB,WAAW,CAC/B,UAACoB,IAAD,EAAsC;IACpC,IAAMC,KAAK,GAAGN,YAAY,CAACK,IAAD,CAA1B;IAEA,OAAOnB,aAAa,CAACoB,KAAD,EAAQX,WAAR,CAApB;EACD,CAL8B,EAM/B,CAACA,WAAD,EAAcK,YAAd,CAN+B,CAAjC;EASA,IAAMO,UAAU,GAAGtB,WAAW,CAC5B,UAACuB,KAAD,EAAqC;IACnC,IAAMF,KAAK,GAAGN,YAAY,CAACQ,KAAD,CAA1B;IAEA,OAAOtB,aAAa,CAACoB,KAAD,EAAQT,aAAR,CAApB;EACD,CAL2B,EAM5B,CAACA,aAAD,EAAgBG,YAAhB,CAN4B,CAA9B;EASA,IAAMS,aAAa,GAAGxB,WAAW,CAC/B,UAACyB,SAAD,EAAkB;IAChB,IAAMC,OAAO,GAAG,UAACL,KAAD,EAAiB;MAC/B,IAAMM,SAAS,GAAGX,kBAAkB,CAACK,KAAD,EAAQI,SAAR,CAApC;MACA,IAAML,IAAI,GAAGN,OAAO,CAACa,SAAS,IAAI,CAAC,CAAC,CAAF,CAAd,CAApB;;MAEA,IAAI,CAACA,SAAD,IAAc,CAACP,IAAnB,EAAyB;QACvB,OAAO,IAAP;MACD;;MAED,IAAMQ,WAAW,GAAGX,cAAc,CAACG,IAAD,CAAlC;MACA,IAAMS,UAAU,GAAGD,WAAW,IAAId,OAAO,CAACc,WAAD,CAAzC;MAEA,OAAO;QAAEP,KAAK,EAAEM,SAAT;QAAoBP,IAAI,MAAxB;QAA0BU,MAAM,EAAED,UAAU,IAAIE;MAAhD,CAAP;IACD,CAZD;;IAcA,IAAMJ,SAAS,GAAGxB,oBAAoB,CAAC;MACrC6B,UAAU,EAAEtB,WADyB;MAErCE,aAAa,eAFwB;MAGrCc,OAAO,SAH8B;MAIrCnB,mBAAmB,qBAJkB;MAKrCE,kBAAkB;IALmB,CAAD,CAAtC;;IAQA,IAAIkB,SAAJ,EAAe;MACbhB,cAAc,CAACgB,SAAD,CAAd;IACD;EACF,CA3B8B,EA4B/B,CAACjB,WAAD,EAAcE,aAAd,EAA6BE,OAA7B,EAAsCE,kBAAtC,EAA0DC,cAA1D,EAA0EV,mBAA1E,EAA+FE,kBAA/F,CA5B+B,CAAjC;EA+BA,IAAMwB,aAAa,GAAGjC,WAAW,CAC/B,UAACoB,IAAD,EAAsC;IACpCT,cAAc,CAACI,YAAY,CAACK,IAAD,CAAb,CAAd;EACD,CAH8B,EAI/B,CAACL,YAAD,CAJ+B,CAAjC;EAOA,IAAMmB,WAAW,GAAGlC,WAAW,CAC7B,UAACuB,KAAD,EAAsC;IACpC,IAAMY,UAAU,GAAGZ,KAAK,GAAGR,YAAY,CAACQ,KAAD,CAAf,GAAyBb,WAAjD;;IACA,IAAM0B,eAAe,mCAAOD,UAAP,EAAiB,IAAjB,GAAiB,CAAE,CAAF,CAAjB,EAAoB,KAApB,CAArB,CAFoC,CAIpC;;;IACAxB,cAAc,CAACF,kBAAkB,GAAG0B,UAAH,GAAgBC,eAAnC,CAAd;IACAvB,gBAAgB,CAACsB,UAAD,CAAhB;EACD,CAR4B,EAS7B,CAACzB,WAAD,EAAcK,YAAd,EAA4BN,kBAA5B,CAT6B,CAA/B;EAYA,IAAM4B,aAAa,GAAGrC,WAAW,CAAC;IAChC,IAAIY,aAAa,CAAC0B,MAAd,GAAuB,CAA3B,EAA8B;MAC5B3B,cAAc,CAACC,aAAD,CAAd;MACAC,gBAAgB,CAACD,aAAa,CAAC2B,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAD,CAAhB;IACD;EACF,CALgC,EAK9B,CAAC3B,aAAD,CAL8B,CAAjC;EAOA,IAAM4B,KAAK,GAAGxC,WAAW,CAAC;IACxBW,cAAc,CAAC,EAAD,CAAd;IACAE,gBAAgB,CAAC,EAAD,CAAhB;EACD,CAHwB,EAGtB,EAHsB,CAAzB;EAKA,OAAO;IACLK,UAAU,YADL;IAELC,aAAa,eAFR;IAGLG,UAAU,YAHL;IAILE,aAAa,eAJR;IAKLS,aAAa,eALR;IAMLC,WAAW,aANN;IAOLG,aAAa,eAPR;IAQLG,KAAK;EARA,CAAP;AAUD","names":["useState","useMemo","useCallback","indexIncludes","createItemsTree","moveHighlightOneStep","useHighlightedMenu","_a","items","hasExpandableGroups","_b","isInRestrictedView","targetIndex","setTargetIndex","expandedIndex","setExpandedIndex","getItem","getItemIndex","getSequentialIndex","getParentIndex","targetItem","isHighlighted","item","index","isExpanded","group","moveHighlight","direction","getNext","nextIndex","parentIndex","parentItem","parent","undefined","startIndex","highlightItem","expandGroup","groupIndex","firstChildIndex","collapseGroup","length","slice","reset"],"sourceRoot":"","sources":["../../../../src/button-dropdown/utils/use-highlighted-menu.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { useState, useMemo, useCallback } from 'react';\n\nimport { indexIncludes } from './utils';\nimport { ButtonDropdownProps, HighlightProps } from '../interfaces';\nimport createItemsTree, { TreeIndex } from './create-items-tree';\nimport moveHighlightOneStep from './move-highlight';\n\ninterface UseHighlightedMenuOptions {\n  items: ButtonDropdownProps.Items;\n  hasExpandableGroups: boolean;\n  isInRestrictedView?: boolean;\n}\n\ninterface UseHighlightedMenuApi extends HighlightProps {\n  moveHighlight: (direction: -1 | 1) => void;\n  expandGroup: (group?: ButtonDropdownProps.ItemGroup) => void;\n  collapseGroup: () => void;\n  reset: () => void;\n}\n\nexport default function useHighlightedMenu({\n  items,\n  hasExpandableGroups,\n  isInRestrictedView = false,\n}: UseHighlightedMenuOptions): UseHighlightedMenuApi {\n  const [targetIndex, setTargetIndex] = useState<TreeIndex>([]);\n  const [expandedIndex, setExpandedIndex] = useState<TreeIndex>([]);\n\n  const { getItem, getItemIndex, getSequentialIndex, getParentIndex } = useMemo(() => createItemsTree(items), [items]);\n\n  const targetItem = useMemo(() => getItem(targetIndex), [targetIndex, getItem]);\n\n  const isHighlighted = useCallback(\n    (item: ButtonDropdownProps.ItemOrGroup) => {\n      const index = getItemIndex(item);\n\n      return indexIncludes(index, targetIndex);\n    },\n    [targetIndex, getItemIndex]\n  );\n\n  const isExpanded = useCallback(\n    (group: ButtonDropdownProps.ItemGroup) => {\n      const index = getItemIndex(group);\n\n      return indexIncludes(index, expandedIndex);\n    },\n    [expandedIndex, getItemIndex]\n  );\n\n  const moveHighlight = useCallback(\n    (direction: -1 | 1) => {\n      const getNext = (index: TreeIndex) => {\n        const nextIndex = getSequentialIndex(index, direction);\n        const item = getItem(nextIndex || [-1]);\n\n        if (!nextIndex || !item) {\n          return null;\n        }\n\n        const parentIndex = getParentIndex(item);\n        const parentItem = parentIndex && getItem(parentIndex);\n\n        return { index: nextIndex, item, parent: parentItem || undefined };\n      };\n\n      const nextIndex = moveHighlightOneStep({\n        startIndex: targetIndex,\n        expandedIndex,\n        getNext,\n        hasExpandableGroups,\n        isInRestrictedView,\n      });\n\n      if (nextIndex) {\n        setTargetIndex(nextIndex);\n      }\n    },\n    [targetIndex, expandedIndex, getItem, getSequentialIndex, getParentIndex, hasExpandableGroups, isInRestrictedView]\n  );\n\n  const highlightItem = useCallback(\n    (item: ButtonDropdownProps.ItemOrGroup) => {\n      setTargetIndex(getItemIndex(item));\n    },\n    [getItemIndex]\n  );\n\n  const expandGroup = useCallback(\n    (group?: ButtonDropdownProps.ItemGroup) => {\n      const groupIndex = group ? getItemIndex(group) : targetIndex;\n      const firstChildIndex = [...groupIndex, 0];\n\n      // move to the first child item unless in restricted mode\n      setTargetIndex(isInRestrictedView ? groupIndex : firstChildIndex);\n      setExpandedIndex(groupIndex);\n    },\n    [targetIndex, getItemIndex, isInRestrictedView]\n  );\n\n  const collapseGroup = useCallback(() => {\n    if (expandedIndex.length > 0) {\n      setTargetIndex(expandedIndex);\n      setExpandedIndex(expandedIndex.slice(0, -1));\n    }\n  }, [expandedIndex]);\n\n  const reset = useCallback(() => {\n    setTargetIndex([]);\n    setExpandedIndex([]);\n  }, []);\n\n  return {\n    targetItem,\n    isHighlighted,\n    isExpanded,\n    moveHighlight,\n    highlightItem,\n    expandGroup,\n    collapseGroup,\n    reset,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}