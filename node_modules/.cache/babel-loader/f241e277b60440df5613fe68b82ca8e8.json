{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { warnOnce } from '../../../internal/logging';\nimport { getWeekStartByLocale } from 'weekstart';\n\nvar getHtmlElement = function () {\n  return typeof document !== 'undefined' ? document.querySelector('html') : null;\n};\n\nfunction getBrowserLocale() {\n  return new Intl.DateTimeFormat().resolvedOptions().locale;\n}\n\nfunction checkLocale(component, locale) {\n  if (!locale || locale === '') {\n    return '';\n  } // Support underscore-delimited locales\n\n\n  locale = locale && locale.replace(/^([a-z]{2})_/, '$1-'); // Check that the value matches aa-BB pattern\n  // TODO: support full BCP 47 spec?\n\n  if (locale && !locale.match(/^[a-z]{2}(-[A-Z]{2})?$/)) {\n    warnOnce(component, \"Invalid locale provided: \".concat(locale, \". Falling back to default\"));\n    locale = '';\n  }\n\n  return locale;\n}\n\nexport function mergeLocales(locale, fullLocale) {\n  var isShort = locale.length === 2;\n\n  if (isShort && fullLocale.indexOf(locale) === 0) {\n    return fullLocale;\n  }\n\n  return locale;\n}\nexport function normalizeLocale(component, locale) {\n  var _a;\n\n  locale = checkLocale(component, locale);\n  var browserLocale = getBrowserLocale();\n\n  if (locale) {\n    return mergeLocales(locale, browserLocale);\n  }\n\n  var htmlLocale = checkLocale(component, (_a = getHtmlElement()) === null || _a === void 0 ? void 0 : _a.getAttribute('lang'));\n\n  if (htmlLocale) {\n    return mergeLocales(htmlLocale, browserLocale);\n  }\n\n  return browserLocale;\n}\nexport function normalizeStartOfWeek(startOfWeek, locale) {\n  return typeof startOfWeek === 'number' ? startOfWeek % 7 : getWeekStartByLocale(locale);\n}","map":{"version":3,"mappings":"AAAA;AACA;AACA,SAASA,QAAT,QAAyB,2BAAzB;AACA,SAASC,oBAAT,QAAqC,WAArC;;AAGA,IAAMC,cAAc,GAAG;EAAM,OAAC,OAAOC,QAAP,KAAoB,WAApB,GAAkCA,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAlC,GAAmE,IAApE;AAAyE,CAAtG;;AAEA,SAASC,gBAAT,GAAyB;EACvB,OAAO,IAAIC,IAAI,CAACC,cAAT,GAA0BC,eAA1B,GAA4CC,MAAnD;AACD;;AAED,SAASC,WAAT,CAAqBC,SAArB,EAAwCF,MAAxC,EAAyE;EACvE,IAAI,CAACA,MAAD,IAAWA,MAAM,KAAK,EAA1B,EAA8B;IAC5B,OAAO,EAAP;EACD,CAHsE,CAKvE;;;EACAA,MAAM,GAAGA,MAAM,IAAIA,MAAM,CAACG,OAAP,CAAe,cAAf,EAA+B,KAA/B,CAAnB,CANuE,CAOvE;EACA;;EACA,IAAIH,MAAM,IAAI,CAACA,MAAM,CAACI,KAAP,CAAa,wBAAb,CAAf,EAAuD;IACrDb,QAAQ,CAACW,SAAD,EAAY,mCAA4BF,MAA5B,EAAkC,2BAAlC,CAAZ,CAAR;IACAA,MAAM,GAAG,EAAT;EACD;;EACD,OAAOA,MAAP;AACD;;AAED,OAAM,SAAUK,YAAV,CAAuBL,MAAvB,EAAuCM,UAAvC,EAAyD;EAC7D,IAAMC,OAAO,GAAGP,MAAM,CAACQ,MAAP,KAAkB,CAAlC;;EACA,IAAID,OAAO,IAAID,UAAU,CAACG,OAAX,CAAmBT,MAAnB,MAA+B,CAA9C,EAAiD;IAC/C,OAAOM,UAAP;EACD;;EACD,OAAON,MAAP;AACD;AAED,OAAM,SAAUU,eAAV,CAA0BR,SAA1B,EAA6CF,MAA7C,EAAkE;;;EACtEA,MAAM,GAAGC,WAAW,CAACC,SAAD,EAAYF,MAAZ,CAApB;EACA,IAAMW,aAAa,GAAGf,gBAAgB,EAAtC;;EACA,IAAII,MAAJ,EAAY;IACV,OAAOK,YAAY,CAACL,MAAD,EAASW,aAAT,CAAnB;EACD;;EACD,IAAMC,UAAU,GAAGX,WAAW,CAACC,SAAD,EAAY,oBAAc,EAAd,MAAgB,IAAhB,IAAgBW,aAAhB,GAAgB,MAAhB,GAAgBA,GAAEC,YAAF,CAAe,MAAf,CAA5B,CAA9B;;EACA,IAAIF,UAAJ,EAAgB;IACd,OAAOP,YAAY,CAACO,UAAD,EAAaD,aAAb,CAAnB;EACD;;EACD,OAAOA,aAAP;AACD;AAED,OAAM,SAAUI,oBAAV,CAA+BC,WAA/B,EAAgEhB,MAAhE,EAA8E;EAClF,OAAQ,OAAOgB,WAAP,KAAuB,QAAvB,GAAkCA,WAAW,GAAG,CAAhD,GAAoDxB,oBAAoB,CAACQ,MAAD,CAAhF;AACD","names":["warnOnce","getWeekStartByLocale","getHtmlElement","document","querySelector","getBrowserLocale","Intl","DateTimeFormat","resolvedOptions","locale","checkLocale","component","replace","match","mergeLocales","fullLocale","isShort","length","indexOf","normalizeLocale","browserLocale","htmlLocale","_a","getAttribute","normalizeStartOfWeek","startOfWeek"],"sourceRoot":"","sources":["../../../../../src/date-picker/calendar/utils/locales.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { warnOnce } from '../../../internal/logging';\nimport { getWeekStartByLocale } from 'weekstart';\nimport { DayIndex } from '..';\n\nconst getHtmlElement = () => (typeof document !== 'undefined' ? document.querySelector('html') : null);\n\nfunction getBrowserLocale() {\n  return new Intl.DateTimeFormat().resolvedOptions().locale;\n}\n\nfunction checkLocale(component: string, locale: string | null | undefined): string {\n  if (!locale || locale === '') {\n    return '';\n  }\n\n  // Support underscore-delimited locales\n  locale = locale && locale.replace(/^([a-z]{2})_/, '$1-');\n  // Check that the value matches aa-BB pattern\n  // TODO: support full BCP 47 spec?\n  if (locale && !locale.match(/^[a-z]{2}(-[A-Z]{2})?$/)) {\n    warnOnce(component, `Invalid locale provided: ${locale}. Falling back to default`);\n    locale = '';\n  }\n  return locale;\n}\n\nexport function mergeLocales(locale: string, fullLocale: string) {\n  const isShort = locale.length === 2;\n  if (isShort && fullLocale.indexOf(locale) === 0) {\n    return fullLocale;\n  }\n  return locale;\n}\n\nexport function normalizeLocale(component: string, locale: string | null): string {\n  locale = checkLocale(component, locale);\n  const browserLocale = getBrowserLocale();\n  if (locale) {\n    return mergeLocales(locale, browserLocale);\n  }\n  const htmlLocale = checkLocale(component, getHtmlElement()?.getAttribute('lang'));\n  if (htmlLocale) {\n    return mergeLocales(htmlLocale, browserLocale);\n  }\n  return browserLocale;\n}\n\nexport function normalizeStartOfWeek(startOfWeek: number | undefined, locale: string) {\n  return (typeof startOfWeek === 'number' ? startOfWeek % 7 : getWeekStartByLocale(locale)) as DayIndex;\n}\n"]},"metadata":{},"sourceType":"module"}